# ANDW 新着お知らせ (ANDW Notices) ユーザーガイド

## インストール手順

### 1. プラグインの有効化
1. WordPressの管理画面にログイン
2. 「プラグイン」→「新規追加」をクリック
3. 「ANDW Notices」を検索してインストール
4. プラグインを有効化

### 2. 動作確認
- 管理画面左側に「お知らせ」メニューが追加されることを確認
- ブロックエディターで「お知らせ一覧」ブロックが利用可能になることを確認

## 基本的な使用方法

### 1. お知らせの作成

1. **管理画面から作成**
   - 「お知らせ」→「新規追加」をクリック
   - タイトル、本文、抜粋を入力
   - 必要に応じてアイキャッチ画像を設定

2. **お知らせ設定の入力**
   - **表示日**: お知らせ一覧での表示順に使用される日付
   - **リンクタイプ**: クリック時の遷移先を選択
     - 自身のページ: このお知らせの詳細ページ
     - 内部ページ: サイト内の投稿・固定ページ
     - 外部URL: 外部サイト
   - **新規タブで開く**: チェックすると target="_blank" で開く

3. **公開**
   - 「公開」ボタンをクリックして保存

### 2. ブロックの挿入

1. **ページ/投稿の編集**
   - お知らせ一覧を表示したいページ・投稿を編集
   - ブロック追加（+）をクリック
   - 「お知らせ一覧」ブロックを検索・選択

2. **ブロック設定の調整**
   - 右側のサイドバーで各種設定を調整
   - プレビューを確認しながら調整可能

3. **保存・公開**
   - 設定完了後、ページを更新または公開

## ブロック設定詳細

### 表示設定
- **表示件数**: 1〜20件で設定可能
- **並び順**: 昇順（古い順）/ 降順（新しい順）
- **並び基準**: 表示日 / 公開日
- **レイアウト**: リスト / カード

### フィルター設定
- **外部リンクを含める**: 外部URLが設定されたお知らせを表示
- **内部リンクを含める**: 内部ページが設定されたお知らせを表示

### 表示要素
- **日付を表示**: 表示日の表示切り替え
- **タイトルを表示**: タイトルの表示切り替え
- **抜粋を表示**: 抜粋の表示切り替え
- **抜粋の文字数**: 50〜300文字で設定

### リンク設定
- **リンク動作の上書き**: 個別設定を一括で上書き
- **新規タブで開く（一括設定）**: すべてのリンクの動作を統一

## 管理機能

### 管理画面一覧
- **表示日カラム**: 各お知らせの表示日を確認
- **リンク先カラム**: 設定されたリンク先を確認
- **クイック編集**: 一覧から直接「表示日」「新規タブ」を編集

### 設定ページ
「お知らせ」→「設定」から以下を調整可能：

- **抜粋の既定文字数**: ブロックのデフォルト値
- **許可するURLプロトコル**: セキュリティ設定
- **日付フォーマット上書き**: 表示形式のカスタマイズ
- **キャッシュ設定**: パフォーマンス調整

## よくある質問

### Q: 表示日と公開日の違いは？
A: 公開日はWordPressの標準機能。表示日はお知らせ一覧での表示専用です。例えば毎月1日掲載のお知らせを事前作成する場合、表示日を1日に設定すると適切な順序で表示されます。

### Q: 外部URLにリンクできない
A: 設定ページでURLプロトコルが許可されているか確認してください。デフォルトはHTTP/HTTPS のみです。

### Q: ブロックが表示されない
A: キャッシュが原因の可能性があります。設定ページから「キャッシュをクリア」を実行してください。

### Q: レイアウトをカスタマイズしたい
A: CSSで以下のクラスをカスタマイズできます：
- `.andw-notices`: メインコンテナ
- `.andw-notice-item`: 各アイテム
- `.andw-notice-date`: 日付部分
- `.andw-notice-title`: タイトル部分
- `.andw-notice-excerpt`: 抜粋部分

## トラブルシューティング

### 管理画面でエラーが表示される
1. プラグインを一旦無効化
2. 他のプラグインとの競合確認
3. WordPressとPHPのバージョン確認（WP 6.2+、PHP 7.4+）

### フロントエンドで表示されない
1. テーマの functions.php で CSS が読み込まれているか確認
2. ブロックが正しく挿入されているか確認
3. お知らせが「公開」状態か確認

### パフォーマンス問題
1. 設定ページでキャッシュ有効期間を長く設定
2. 表示件数を減らす
3. 不要な表示要素を非表示にする

## 開発者向け情報

### フィルターフック
```php
// 許可するURLプロトコルの変更
add_filter( 'andw_notices_allowed_url_protocols', function( $protocols ) {
    return array( 'https' ); // HTTPSのみ許可
});
```

### アクションフック
```php
// キャッシュクリア時の処理
add_action( 'andw_notices_cache_cleared', function() {
    // カスタム処理
});
```

## サポート

技術的な問題や機能リクエストは、プラグイン開発者までお問い合わせください。

- 開発者: yasuo3o3
- ウェブサイト: https://yasuo-o.xyz/